---
import Layout from '~/layouts/PageLayout.astro';
import Hero from '~/components/widgets/Hero.astro';
import Note from '~/components/widgets/Note.astro';
import TechStack from '~/components/widgets/TechStack.astro';
import CallToAction from '~/components/widgets/CallToAction.astro';
import BlogLatestPosts from '~/components/widgets/BlogLatestPosts.astro';
import ProjectList from '~/components/projects/ProjectList.astro';
import { experiences } from '~/data/experience';
import Experience from '~/components/widgets/Experience.astro';
import { achievements, certifications } from '~/data/achievements';
import AchievementsAndCertifications from '~/components/widgets/AchievementsAndCertifications.astro';
import AdBloglist from '~/components/ads/AdBloglist.astro';
import { findImageWithFallback } from '~/utils/images';

const projectFiles = import.meta.glob('./../data/projects/*.mdx');
let projects = await Promise.all(
  Object.entries(projectFiles).map(async ([path, resolver]) => {
    const mod = await resolver();
    let image = await findImageWithFallback(mod.frontmatter.image);
    return {
      ...mod.frontmatter,
      image,
      slug: mod.frontmatter.slug || path.split('/').pop().replace('.mdx', ''),
    };
  })
);

// Sort: projects with 'latest' in status come first
projects = projects.sort((a, b) => {
  const aLatest = Array.isArray(a.status) && a.status.includes('latest');
  const bLatest = Array.isArray(b.status) && b.status.includes('latest');
  if (aLatest === bLatest) return 0;
  return aLatest ? -1 : 1;
});

// Select top 3 as featured projects
const featuredProjects = projects.slice(0, 3);

const metadata = {
  title: 'Neeraj Singh - Cybersecurity Engineer & Software Testing Professional',
  description: 'Welcome to Neerajlovecyber, the personal website of Neeraj Singh, a Cybersecurity Engineer. Explore articles on reverse engineering, cybersecurity, crypto forensics, CTF challenges, HackTheBox, TryHackMe walkthroughs, penetration testing, ethical hacking techniques, and vulnerability assessments.',
  ignoreTitleTemplate: true,
};
---

<Layout metadata={metadata}>
  <!-- Hero Widget ******************* -->

  <Hero
    actions={[
      {
        variant: 'primary',
        text: 'Download CV',
        href: '#',
        target: '_blank',
        icon: 'tabler:download',
      },
      {
        variant: 'secondary',
        text: 'Contact Me',
        href: 'whatsapp://send?phone=+917988815263&text=Hi Neeraj, I would like to connect with you.',
        icon: 'tabler:brand-whatsapp',
        target: '_blank',
      },
    ]}
  >
    <Fragment slot="title">
      Hi, I'm <span class="text-accent dark:text-white">Neeraj Singh</span>.<br />
      Cybersecurity Engineer
    </Fragment>

    <Fragment slot="subtitle">
      <span class="font-semibold">Specialized in Cyber Security, Software Testing and Developement</span>
      <span class="block mt-1 text-gray-600 dark:text-slate-400">
        I'm Neeraj Singh Panghal, currently working as a Cybersecurity Engineer . I have hands-on experience with
        security assessments, CTFs, HackTheBox, and TryHackMe challenges. Passionate about implementing robust security
        solutions.
      </span>
    </Fragment>
  </Hero>

  <!-- Note Widget ******************* -->

  <!-- Cybersecurity Philosophy Note: Highlights our core security principles -->
  <Note
    icon="tabler:shield-lock"
    title="Security Philosophy:"
    description="Defense in Depth, Zero Trust, and Proactive Protection"
    aria-label="Our cybersecurity approach"
  />

  <TechStack />

  <!-- Professional Experience -->
  <section class="px-4 py-16 mx-auto max-w-6xl lg:py-20">
    <div class="mb-10 md:mx-auto text-center md:mb-12 max-w-3xl">
      <h2 class="text-4xl md:text-5xl font-bold leading-tighter tracking-tighter mb-4 font-heading">
        Professional Experience
      </h2>
      <p class="max-w-3xl mx-auto sm:text-center text-xl text-gray-600 dark:text-slate-400">
        A brief overview of my professional journey in cybersecurity and software testing
      </p>
    </div>
    <Experience experiences={experiences} />
  </section>

  <!-- Achievements and Certifications -->
  <AchievementsAndCertifications
    achievements={achievements}
    certifications={certifications}
  />

  <!-- Featured Projects -->
  <section class="px-4 py-16 mx-auto max-w-6xl lg:py-20">
    <div class="mb-10 md:mx-auto text-center md:mb-12 max-w-3xl">
      <h2 class="text-4xl md:text-5xl font-bold leading-tighter tracking-tighter mb-4 font-heading">
        Featured Projects
      </h2>
      <p class="max-w-3xl mx-auto sm:text-center text-xl text-gray-600 dark:text-slate-400">
        Check out some of my latest work in cybersecurity and software development
      </p>
    </div>
    <ProjectList projects={featuredProjects}
    />
    <div class="text-center mt-8">
      <a
        href="/projects"
        class="btn btn-primary  font-bold py-3 px-6 rounded-lg inline-flex items-center transition duration-150 ease-in-out"
      >
        
        View All Projects
      </a>
    </div>
  </section>

  <BlogLatestPosts
    title="Latest Blog Posts"
  />
  <div class="text-center mt-8">

  <AdBloglist /> </div>
  <CallToAction
    actions={[
      {
        variant: 'primary',
        text: "Let's Connect",
        href: 'https://linkedin.com/in/neerajlovecyber',
        target: '_blank',
        icon: 'tabler:brand-linkedin',
      },
    ]}
  >
    <Fragment slot="title">
      Want to work <br class="block sm:hidden" /><span class="sm:whitespace-nowrap"> together?</span>
    </Fragment>

    <Fragment slot="subtitle">
      I'm always open to discussing cybersecurity projects and opportunities.<br class="hidden md:inline" />
      Let's connect and make the digital world more secure!
    </Fragment>
  </CallToAction>
</Layout>

